# LLMC Agent Instructions

> **Drop this line in your AGENTS.md / CLINE.md / GEMINI.md:**
> `Read and follow ~/.llmc/LLMCAGENTS.md OR <repo>/.llmc/LLMCAGENTS.md before using LLMC tools.`

## What is LLMC?

LLMC (LLM Cost Compression) is a local RAG (Retrieval Augmented Generation) system that indexes, enriches, and embeds codebases. It gives you semantic search over code without burning API tokens.

**You have access to LLMC via CLI commands.** Use them to search code, get context, and understand projects.

---

## üöÄ Bootstrap (Start Here)

Before doing ANY code work in a repo, run these two commands:

```bash
# 1. Check if repo is set up for LLMC
llmc-cli repo list

# 2. Search for relevant code (your first query)
cd /path/to/repo && llmc-cli analytics search "your topic"
```

**If the repo isn't listed:** Run `llmc-cli repo register /path/to/repo` to bootstrap it.

---

## üìã Core Commands (80% of usage)

### Semantic Search
```bash
# Search enriched code summaries (fast, uses local embeddings)
llmc-cli analytics search "authentication flow"
llmc-cli analytics search "database connection" --limit 10
```

### Repository Stats & Health
```bash
# Quick stats for current repo
llmc-cli analytics stats

# Full repo status with enrichment progress
llmc-cli repo list
```

### Navigation Tools
```bash
# Find where a symbol is used (callers, importers)
llmc-cli analytics where-used "function_name"

# Show symbol lineage (parents, children, dependencies)
llmc-cli analytics lineage "ClassName"
```

---

## üéØ Progressive Disclosure Rules

**DO NOT** dump all commands at once. Follow these rules:

1. **Start with `analytics search`** for any new topic
2. **Only use `where-used`** when you need to trace callers
3. **Use grep** for exact string matches (function names, imports, etc.)
4. **Check `repo list`** if searches return empty or stale results

### When to Use Which Command

| Goal | Command |
|------|---------|
| "Find code related to X" | `llmc-cli analytics search "X"` |
| "Find exact function name" | `grep -r "function_name" .` |
| "Where is this called from?" | `llmc-cli analytics where-used "func"` |
| "What does this depend on?" | `llmc-cli analytics lineage "Class"` |
| "How big is the index?" | `llmc-cli analytics stats` |
| "Is enrichment running?" | `llmc-cli repo list` |

---

## üîß Service Management

```bash
# Check daemon status (handles background enrichment)
llmc-cli service status

# View enrichment logs
llmc-cli service logs -f

# Restart service (triggers re-enrichment)
llmc-cli service restart
```

---

## üß† Token-Saving Guidelines

1. **Never query the entire codebase** - Always filter by topic or file
2. **Limit search results** - Use `--limit 5` unless you need more
3. **Prefer summaries over raw code** - `analytics search` returns enriched summaries
4. **Use progressive refinement** - Start broad, then narrow down

### Example Workflow

```bash
# Step 1: Broad search
llmc-cli analytics search "user authentication"

# Step 2: Found auth/handler.py looks relevant, trace its usage
llmc-cli analytics where-used "authenticate_user"

# Step 3: Need exact import, use grep
grep -r "from auth import" .
```

---

## ‚ùå Anti-Patterns

**DON'T:**
- Run `analytics search` with no query or very broad terms
- Dump entire file contents when summaries suffice
- Skip checking `repo list` when results seem wrong
- Ignore the daemon (`service status`) if enrichment seems stale

**DO:**
- Start with specific queries
- Use `--limit` to control output size
- Check index health when things seem off
- Trust the summaries - they're generated by LLMs specifically for code understanding

---

## üè• Troubleshooting

### "No results found"
```bash
llmc-cli analytics stats  # Check index health
llmc-cli service status   # Is daemon running?
```

### "Results seem stale"
```bash
llmc-cli service restart  # Trigger re-enrichment
llmc-cli repo list        # See pending work
```

### "Repo not recognized"
```bash
llmc-cli repo register .  # Bootstrap the repo
llmc-cli repo validate .  # Check config
```

---

## üìç Quick Reference

```
llmc-cli analytics search "query"     ‚Üí Semantic search (start here!)
llmc-cli analytics where-used "sym"   ‚Üí Find callers/importers
llmc-cli analytics lineage "sym"      ‚Üí Show dependencies
llmc-cli analytics stats              ‚Üí Index statistics
llmc-cli repo list                    ‚Üí All repos + enrichment status
llmc-cli repo register PATH           ‚Üí Bootstrap new repo
llmc-cli service status               ‚Üí Daemon health
llmc-cli service logs -f              ‚Üí Watch enrichment logs
```

---

*This file is auto-installed by `llmc repo register`. Version: 2025-12-08*

