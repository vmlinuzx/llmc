{
  "path": "llmc/cli.py",
  "source_mode": "symbol",
  "snippet": "LLMC_ROOT = Path(\n    __file__\n).parent.parent.parent  # Assumes llmc/cli.py is in llmc/llmc/cli.py\n\n\ndef get_repo_stats(repo_root: Path) -> dict[str, Any]:\n    \"\"\"Fetch real-time stats from the repo's RAG data.\"\"\"\n    stats = {\n        \"files_tracked\": 0,\n        \"graph_nodes\": 0,\n        \"enriched_nodes\": 0,\n        \"token_usage\": 0,\n        \"freshness_state\": \"UNKNOWN\",\n        \"daemon_status\": \"OFFLINE\",\n        \"last_indexed_at\": \"Never\",\n        \"error\": None,\n    }\n\n    try:\n        # Get index status\n        index_status = load_status(repo_root)\n        if index_status:\n            stats[\"freshness_state\"] = index_status.index_state\n            stats[\"last_indexed_at\"] = (\n                index_status.last_indexed_at\n                if index_status.last_indexed_at\n                else \"Never\"\n            )\n\n        # Get graph stats\n        nodes, _ = _load_graph(repo_root)\n        stats[\"graph_nodes\"] = len(nodes)\n        stats[\"enriched_nodes\"] = sum(\n            1 for n in nodes if n.get(\"metadata\", {}).get(\"summary\")\n        )\n\n        # Approximate token usage (simple heuristic: 4 chars/token avg)\n        # This is a placeholder; real token count would be in the DB.\n        total_content_len = sum(\n            len(n.get(\"metadata\", {}).get(\"summary\", \"\")) for n in nodes\n        )\n        stats[\"token_usage\"] = total_content_len // 4  # Rough estimate\n\n        # Daemon status (placeholder for now, real implementation would read PID file or socket)\n        # For demo, assume ON if graph exists.\n        if Path(repo_root / \".llmc\" / \"rag\" / \"index_v2.db\").exists():\n            stats[\"daemon_status\"] = \"ONLINE\"\n        else:\n            stats[\"daemon_status\"] = \"OFFLINE\"\n\n... (truncated)",
  "full_source": null,
  "primary_span": [
    49,
    103
  ],
  "file_summary": "Fetches real-time repository stats from RAG data including file count, graph nodes, token usage, and freshness. Updates status based on index and graph data. Returns structured stats with error handling.",
  "graph_status": "connected",
  "defined_symbols": [
    {
      "name": "DashboardState",
      "line": 106,
      "type": "class",
      "summary": "DashboardState manages a CLI interface with system monitoring, code search, and configuration options. It tracks logs with timestamps and colors, maintains menu navigation, and updates system stats. Logs are limited to 15 entries. Initialized with repo root, it starts with minimal stats and triggers immediate stats update."
    },
    {
      "name": "monitor",
      "line": 186,
      "type": "function",
      "summary": "Launches a 6-Panel Dashboard with header and footer panels. Displays version and repo path in header. Shows quit, save, and help options in footer. Updates interface in real-time with live refresh. Runs in a loop until user quits."
    },
    {
      "name": "get_repo_stats",
      "line": 49,
      "type": "function",
      "summary": "Fetches real-time repository stats from RAG data including file count, graph nodes, token usage, and freshness. Updates status based on index and graph data. Returns structured stats with error handling."
    },
    {
      "name": "make_layout",
      "line": 153,
      "type": "function",
      "summary": "Defines a 6-panel grid layout for UI components. Creates a header, body, and footer with vertical splits. The body divides into left and right panels. Left contains menu and help sections. Right contains context and log sections, with logs getting twice the space. All panels are named and sized for responsive design."
    },
    {
      "name": "update",
      "line": 129,
      "type": "function",
      "summary": "Updates real-time repository stats every 2 seconds or on error. Fetches stats from repo root, logs errors or success. Simulates log entries by randomly enriching Python files with bold formatting."
    },
    {
      "name": "search",
      "line": 180,
      "type": "function",
      "summary": null
    },
    {
      "name": "route",
      "line": 312,
      "type": "function",
      "summary": null
    },
    {
      "name": "add_log",
      "line": 122,
      "type": "function",
      "summary": null
    },
    {
      "name": "__init__",
      "line": 107,
      "type": "function",
      "summary": null
    }
  ],
  "parents": [],
  "children": [],
  "incoming_calls": [
    {
      "symbol": "cli.DashboardState.update",
      "path": "llmc/cli.py"
    }
  ],
  "outgoing_calls": [
    {
      "symbol": "sym:cli._load_graph",
      "path": ""
    },
    {
      "symbol": "sym:cli.exists",
      "path": ""
    },
    {
      "symbol": "sym:cli.get",
      "path": ""
    }
  ],
  "related_tests": [],
  "related_docs": [],
  "enrichment": {
    "summary": "Fetches real-time repository stats from RAG data including file count, graph nodes, token usage, and freshness. Updates status based on index and graph data. Returns structured stats with error handling.",
    "inputs": [
      "repo_root: Path"
    ],
    "outputs": [
      "dict[str, Any]"
    ],
    "side_effects": [],
    "pitfalls": [],
    "evidence_count": 1
  },
  "provenance": {
    "kind": "code",
    "last_commit": "3508659",
    "last_commit_date": "2025-12-17",
    "indexed_at": null
  }
}
